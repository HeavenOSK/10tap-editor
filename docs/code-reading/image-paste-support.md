# 画像貼り付け機能の実装状況

## 概要
TenTapエディターにおける画像貼り付け機能の実装状況について調査を行いました。

## 現状の実装

### 画像機能の基本実装
- `src/bridges/image.ts` に画像関連の基本機能が実装されています
- base64形式の画像をサポートしています（`allowBase64: true`）
- `setImage` メソッドを通じて画像を挿入できる仕組みが実装されています

### 画像機能の組み込み
- `src/bridges/StarterKit.ts` において `ImageBridge` が TenTapStartKit に含まれており、デフォルトで利用可能な状態です
- WebViewベースのエディター実装（`src/simpleWebEditor/Tiptap.tsx`）で画像機能が有効化されています

## 画像挿入に関する制限事項

### 未実装の機能
1. ユーザーインターフェース
   - ツールバーに画像挿入ボタンが実装されていません
   - 画像をアップロードするUIが存在しません
   - サンプル実装（Advanced）でも、画像は initialContent として静的に挿入されているのみです

2. クリップボード操作
   - クリップボードからの画像貼り付け（ペースト）に関するイベントハンドリングの実装が存在しません
   - 画像の挿入機能自体は実装されていますが、ペーストイベントとの連携が実装されていない状態です

### 技術的な課題
1. ユーザーインターフェース
   - 画像挿入ボタンの実装が必要です
   - 画像アップロード機能の実装が必要です
   - モバイルデバイスでの画像選択UIの実装が必要です

2. WebViewでのクリップボードイベントハンドリング
   - 現状、WebView内でのペーストイベントを捕捉する実装が存在しません
   - クリップボードの内容を適切に処理する仕組みが必要です

3. 画像データの変換
   - クリップボードから取得した画像データをbase64形式に変換する処理が必要です
   - 変換後のデータを既存の `setImage` 機能と連携させる実装が必要です

## 関連ファイル
- `src/bridges/image.ts` - 画像機能の基本実装
- `src/bridges/StarterKit.ts` - 画像機能の組み込み
- `src/RichText/RichText.tsx` - WebViewベースのエディター実装
- `src/simpleWebEditor/Tiptap.tsx` - Tiptapエディターの実装

## 今後の改善案
画像機能を実装する場合、以下のような対応が必要です：

1. ユーザーインターフェースの実装
   - ツールバーへの画像挿入ボタンの追加
   - 画像アップロード機能の実装
   - モバイルデバイスでの画像選択UIの実装

2. クリップボード機能の実装
   - WebView内でのクリップボードイベントハンドリングの実装
   - ペーストされた画像データのbase64形式への変換処理の実装
   - 既存の `setImage` 機能との連携実装

これらの実装により、ユーザーが期待する画像貼り付け機能を提供することが可能になります。
